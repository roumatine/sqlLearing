# 多表查询 #
· 多表关系
基本分为三种:
1. 一对多(多对一)
   案例: 部门和员工的关系
   关系: 一个部门对应多个员工, 一个员工只属于一个部门
   实现：在多的一方建立外键(员工), 指向一的一方的主键(部门)
2. 多对多
   案例: 学生和课程的关系
   关系: 一个学生可以选多门课程, 一个课程也可以有多个学生选
   实现: 建立第三张中间表, 中间表至少包含两个外键, 分别关联两方主键
3. 一对一
   案例: 用户与用户的关系
   关系: 一对一关系,多用于单标拆分,将一张的基础字段放在一张表中,其他详情字段放在另一只张表中,以提升操作效率
   实现: 在任意一方加入外键,关联另一方主键,并设置外键为唯一的(UNIQUE)

· 多表查询概述
概述:从多张表中数据查询
笛卡尔积: 是指在数学中两个集合,集合a和集合b的所有组合情况(对表查询时,需要消除无效笛卡尔积)
分类:
1. 连接查询
    1. 内连接 : 查询A、B表交集的数据
    2. 外连接 :
        1. 左外连接 : 查询左表所有数据,以及两张表交际部分数据
        2. 右外连接 : 查询右表所有数据,以及两张表交际部分数据
    3. 自连接 : 当前表与自身的连接查询,自连接不许使用表别名 
2. 子查询
· 内连接
查询两表交际部分
   1. 隐式内连接
        SELECT 字段列表 FROM 表1,表2 WHERE 条件...;
   2. 显示内连接
        SELECT 字段列表 FROM 表1 [INNER] JOIN 表2 ON 连接条件...;
        <!-- 通过on消除笛卡尔积部分 -->
<!-- 区别在表的连接形式和连接条件的表示形式 -->
· 外连接
   1. 左外连接
    SELECT 字段列表 FROM 表1 LEFT [OUTER] JOIN 表2 ON 连接条件...; 
    <!-- 相当于查询表1所有数据,以及两张表交际部分数据 -->
   2. 右外连接
    SELECT 字段列表 FROM 表1 RIGHT [OUTER] JOIN 表2 ON 连接条件...;
    <!-- 相当于查询表2所有数据,以及两张表交际部分数据 -->
· 自连接 : 可以是内连接查询也可以是外连接查询
    SELECT 字段列表 FROM 表A 别名A JOIN 表A 别名B ON 条件...;
    <!-- 注： 起别名 -->

· 子查询 : SQL语句中嵌套SELECT语句成为嵌套查询,又称子查询
<!-- 要起别名否则无法分清条件来自哪个表 -->
   SELECT * FROM t1 WHERE column1 = (SECLECT column1 FROM t2);
<!-- 子查询外部的语句可以是INSERT,UPDATE,DELETE,SELECT的任何一个 -->
根据子查询结果不同分为:
1. 标量子查询(子查询结果为单个值)
   子查询结果是单个值,可以是数字、字符串、日期等,最简答的子查询,称为标量子查询
   常用操作符: =, <>, >, >=, <, <=
2. 列子查询(子查询结果为一列)
   子查询返回的结果是一列(可以是多行)
   常用操作符: IN, NOT IN, ANY, SOME, ALL
   ANY 子查询返回列表中有任一满足即可
   SOME 同ANY
   ALL 子查询所有制必须满足
3. 行子查询(子查询结果为一行)
   子查询返回的结果是一行(可以是多列)
   常用操作符: =, <>, IN, NOT IN
4. 表子查询(子查询结果为多行多列)
根据子查询位置分类:
常用操作符: IN
    WHERE之后/SELECT之后/FROM之后
     
· 多表查询案例 in exmple5

· 联合查询 -union, union all
    对于union 查询就是把多次查询结果合并起来,形成一个新的查询结果集
SELECT 字段列表 FROM 表A ...
UNION [ALL]
SELECT 字段列表 FROM 表B ...;
<!-- 对于联合查询的多张表的列数必须保持一致, 字段类型也需要保持一致.
union all 会将全部数据直接合并到一起, union会对合并后数据去重 -->